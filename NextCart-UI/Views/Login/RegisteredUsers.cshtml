@using ECommerce.Repository.Entity
@using ECommerce.Repository.Models
@model List<User>

<div class="container mt-4">

    <hr />
    @* Styled Search Bar for Customers (Username or Email) *@
    <div class="row justify-content-center">
        @* Added row to center and control width *@
        <div class="col-md-8">
            @* Added col-md-8 to reduce width from left and right *@
            <form asp-action="RegisteredUsers" asp-controller="Login" method="get" class="mb-4">
                <div class="input-group input-group-lg">
                    @* Added input-group-lg for a larger input field *@
                    <input type="text" name="searchTerm" class="form-control" placeholder="Search by Username or Email..."
                           value="@ViewData["CurrentFilter"]" aria-label="Search customer" />
                    <button class="btn btn-warning" type="submit">
                        @* Changed to btn-primary for a more prominent search button *@
                        <i class="fas fa-search me-2"></i> Search
                    </button>
                    @if (!string.IsNullOrEmpty(ViewData["CurrentFilter"] as string))
                    {
                        <a asp-action="RegisteredUsers" asp-controller="Login" class="btn btn-outline-danger" title="Clear Search">
                            <i class="fas fa-times me-2"></i> Clear
                        </a>
                    }
                </div>
            </form>
        </div>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>Customer List</h3>
        <a asp-action="Profile" asp-controller="Login" class="btn btn-info">
            <i class="fas fa-user-circle"></i> My Profile
        </a>
    </div>

    @if (Model != null && Model.Any())
    {
        <div class="table-responsive">
            <table class="table table-hover table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Registered Date</th> @* IMPORTANT: Still using LockoutEnd as a placeholder. See notes below. *@
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var customer in Model)
                    {
                        <tr>
                            <td>@customer.UserName</td>
                            <td>@customer.Email</td>
                            @* As discussed, LockoutEnd is not a registration date.
                                       For a true registration date, you need to add a 'RegistrationDate' property
                                       (e.g., public DateTime RegistrationDate { get; set; }) to your
                                       ECommerce.Repository.Models.User class and set it during user registration. *@
                            <td>@(customer.LockoutEnd.HasValue ? customer.LockoutEnd.Value.ToLocalTime().ToString("yyyy-MM-dd HH:mm") : "N/A")</td>
                            <td>
                                <a asp-action="ViewUserDetails" asp-controller="Login" asp-route-id="@customer.Id" class="btn btn-sm btn-outline-primary me-2">
                                    <i class="fas fa-eye"></i> View @* Changed text to View/Update *@
                                </a>
                                
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
    else
    {
        <div class="alert alert-info" role="alert">
            No customers found.
        </div>
    }
</div>